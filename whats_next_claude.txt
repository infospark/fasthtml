## Where We Are

Live graph updates are working end-to-end. Server-side mutations publish
typed events (NodeAdded/EdgeAdded) via pub/sub, stream to the browser over
SSE, and the browser-side EventSource JS calls cy.add() to update Cytoscape
in real time. E2E test confirms the full flow.

### What's been done:

1. **Graph mutation methods are now private** (_add_node, _add_edge, etc.)
   All mutations go through GraphManager.add_node() / add_edge() which
   validate, mutate the graph, and publish events to subscribers.

2. **Event dataclasses created**: NodeAdded(graph_id, node), EdgeAdded(graph_id, edge)
   - GraphEvent = NodeAdded | EdgeAdded (type alias in data_types.py)

3. **Old publish() removed** - replaced by internal _publish(event) that sends
   individual events (no more deep copying entire graphs).

4. **Three-layer SSE architecture** complete:
   - Layer 1: graph_event_to_sse_data() - pure function: GraphEvent -> JSON string
   - Layer 2: graph_sse_stream() - async generator: subscribes to GraphManager, yields SSE-formatted strings
   - Layer 3: SSE route handler in graph_routes.py (GET /graph/events)

5. **Browser-side EventSource JS** in get_graph_sse_script() - listens for
   graph_update events and calls cy.add() for node_added/edge_added.

6. **E2E tests separated** into tests_e2e/ directory to isolate Playwright's
   event loop from pytest-asyncio unit tests. build.sh and CI updated.

7. **E2E test for live updates** - test_graph_page_adds_node_to_existing_graph
   verifies server-side add_node/add_edge appears in the browser via SSE.

### What's next:

1. **Graph visuals** - improve the look and feel of the graph:
   - Node icons (e.g. different icons for different node types)
   - Layout options (explore Cytoscape layouts beyond cose)
   - Styling (colours, shapes, sizing, labels)

2. **User interactions** - reflecting user changes (e.g. moving/editing nodes)
   back to the server via POST events. Needs some design thought.
